import{u as M,f as te,g as se,h as _,i as le,P as re,t as ae,j as oe,k as L,l as C,m as ie,n as U,p as s,q as ue,R as T,s as ne,v as ce,x as pe,C as me,y as he,z as ve,A as ye,B as de,D as ge,E as je,F as fe,G as $,H as B,I as He,J as Q,K as Re}from"./app-Dt9uE4aU.js";const ke=["/","/curriculum-vitae/","/jp/","/info/","/my-projects/Brushless%20motor%20drive%20circuit%20and%20FOC%20control%20algorithm%20design.html","/my-projects/Car%20following%20driving%20system.html","/my-projects/High-throughput%20phenotype%20monitoring%20system%20for%20potted%20plants.html","/my-projects/Moving%20target%20control%20and%20automatic%20tracking%20system.html","/my-projects/Non-contact%20object%20size%20and%20shape%20measurement.html","/my-projects/","/my-projects/Rolling%20ball%20control%20system.html","/my-projects/Smart%20medicine%20delivery%20car.html","/zh/","/jp/curriculum-vitae/","/jp/my-projects/Brushless%20motor%20drive%20circuit%20and%20FOC%20control%20algorithm%20design.html","/jp/my-projects/Car%20following%20driving%20system.html","/jp/my-projects/High-throughput%20phenotype%20monitoring%20system%20for%20potted%20plants.html","/jp/my-projects/Moving%20target%20control%20and%20automatic%20tracking%20system.html","/jp/my-projects/Non-contact%20object%20size%20and%20shape%20measurement.html","/jp/my-projects/","/jp/my-projects/Rolling%20ball%20control%20system.html","/jp/my-projects/Smart%20medicine%20delivery%20car.html","/zh/curriculum-vitae/","/zh/my-projects/Brushless%20motor%20drive%20circuit%20and%20FOC%20control%20algorithm%20design.html","/zh/my-projects/Car%20following%20driving%20system.html","/zh/my-projects/High-throughput%20phenotype%20monitoring%20system%20for%20potted%20plants.html","/zh/my-projects/Moving%20target%20control%20and%20automatic%20tracking%20system.html","/zh/my-projects/Non-contact%20object%20size%20and%20shape%20measurement.html","/zh/my-projects/","/zh/my-projects/Rolling%20ball%20control%20system.html","/zh/my-projects/Smart%20medicine%20delivery%20car.html","/404.html"],we="SEARCH_PRO_QUERY_HISTORY",g=M(we,[]),Ce=()=>{const{queryHistoryCount:l}=Q,r=l>0;return{enabled:r,queryHistory:g,addQueryHistory:a=>{r&&(g.value=Array.from(new Set([a,...g.value.slice(0,l-1)])))},removeQueryHistory:a=>{g.value=[...g.value.slice(0,a),...g.value.slice(a+1)]}}},O=l=>ke[l.id]+("anchor"in l?`#${l.anchor}`:""),Qe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:I}=Q,j=M(Qe,[]),Se=()=>{const l=I>0;return{enabled:l,resultHistory:j,addResultHistory:r=>{if(l){const a={link:O(r),display:r.display};"header"in r&&(a.header=r.header),j.value=[a,...j.value.slice(0,I-1)]}},removeResultHistory:r=>{j.value=[...j.value.slice(0,r),...j.value.slice(r+1)]}}},qe=l=>{const r=me(),a=_(),S=he(),i=L(0),R=C(()=>i.value>0),v=ve([]);return ye(()=>{const{search:y,terminate:q}=de(),f=He(c=>{const H=c.join(" "),{searchFilter:x=h=>h,splitWord:b,suggestionsFilter:A,...d}=r.value;H?(i.value+=1,y(c.join(" "),a.value,d).then(h=>x(h,H,a.value,S.value)).then(h=>{i.value-=1,v.value=h}).catch(h=>{console.warn(h),i.value-=1,i.value||(v.value=[])})):v.value=[]},Q.searchDelay-Q.suggestDelay);U([l,a],([c])=>f(c),{immediate:!0}),ge(()=>{q()})}),{isSearching:R,results:v}};var be=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:r}){const a=se(),S=_(),i=le(re),{enabled:R,addQueryHistory:v,queryHistory:y,removeQueryHistory:q}=Ce(),{enabled:f,resultHistory:c,addResultHistory:H,removeResultHistory:x}=Se(),b=R||f,A=ae(l,"queries"),{results:d,isSearching:h}=qe(A),o=oe({isQuery:!0,index:0}),p=L(0),m=L(0),E=C(()=>b&&(y.value.length>0||c.value.length>0)),z=C(()=>d.value.length>0),D=C(()=>d.value[p.value]||null),N=()=>{const{isQuery:e,index:t}=o;t===0?(o.isQuery=!e,o.index=e?c.value.length-1:y.value.length-1):o.index=t-1},Y=()=>{const{isQuery:e,index:t}=o;t===(e?y.value.length-1:c.value.length-1)?(o.isQuery=!e,o.index=0):o.index=t+1},G=()=>{p.value=p.value>0?p.value-1:d.value.length-1,m.value=D.value.contents.length-1},J=()=>{p.value=p.value<d.value.length-1?p.value+1:0,m.value=0},K=()=>{m.value<D.value.contents.length-1?m.value+=1:J()},V=()=>{m.value>0?m.value-=1:G()},F=e=>e.map(t=>Re(t)?t:s(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=je[e.index]||"$content",[u,w=""]=fe(t)?t[S.value].split("$content"):t.split("$content");return e.display.map(n=>s("div",F([u,...n,w])))}return e.display.map(t=>s("div",F(t)))},k=()=>{p.value=0,m.value=0,r("updateQuery",""),r("close")},X=()=>R?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.queryHistory),y.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===t}],onClick:()=>{r("updateQuery",e)}},[s($,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:B,onClick:u=>{u.preventDefault(),u.stopPropagation(),q(t)}})]))])):null,Z=()=>f?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.resultHistory),c.value.map((e,t)=>s(T,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===t}],onClick:()=>{k()}},()=>[s($,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(u=>F(u)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:B,onClick:u=>{u.preventDefault(),u.stopPropagation(),x(t)}})]))])):null;return ie("keydown",e=>{if(l.isFocusing){if(z.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const t=D.value.contents[m.value];v(l.queries.join(" ")),H(t),a.push(O(t)),k()}}else if(f){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:t}=o;o.isQuery?(r("updateQuery",y.value[t]),e.preventDefault()):(a.push(c.value[t].link),k())}}}}),U([p,m],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!z.value:!E.value}],id:"search-pro-results"},l.queries.length?h.value?s(ue,{hint:i.value.searching}):z.value?s("ul",{class:"search-pro-result-list"},d.value.map(({title:e,contents:t},u)=>{const w=p.value===u;return s("li",{class:["search-pro-result-list-item",{active:w}]},[s("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),t.map((n,ee)=>{const P=w&&m.value===ee;return s(T,{to:O(n),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{v(l.queries.join(" ")),H(n),k()}},()=>[n.type==="text"?null:s(n.type==="title"?ne:n.type==="heading"?ce:pe,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?s("div",{class:"content-header"},n.header):null,s("div",W(n))])])})])})):i.value.emptyResult:b?E.value?[X(),Z()]:i.value.emptyHistory:i.value.emptyResult)}});export{be as default};
